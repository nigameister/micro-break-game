<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Micro-Break Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --color-bg: #DDE8EA;
      --color-text-main: #1C3D41;
      --color-text-header: #2F5C63;
      --color-primary: #C2D6D9;
    }

    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: var(--color-bg);
      height: 100%;
      width: 100%;
      font-family: sans-serif;
    }

    #game-container {
      position: relative;
      width: 100%;
      height: 100vh;
    }

    #blob-container {
      position: absolute;
      top: 45%;
      left: 50%;
      width: 300px;
      height: 270px;
      transform: translate(-50%, -50%);
      z-index: -0.5;
      pointer-events: none;
    }

    #custom-blob {
      width: 100%;
      height: 100%;
      opacity: 0.5;
    }

    canvas {
      position: relative;
      z-index: 0;
      display: block;
    }
  </style>
</head>

<body>
  <div id="game-container">
    <div id="blob-container">
      <svg id="custom-blob" viewBox="0 0 523 475" xmlns="http://www.w3.org/2000/svg">
        <path fill="#DDE8EA"
          d="M65.1,436C65.1,436,-55.767,369.868,31.1,238.1C119.767,108.132,49.833,-41.71,242.1,11.1C436.167,65.71,631.965,276.879,450.1,332.1C270.035,389.121,206.863,546.998,65.1,436Z" />
      </svg>
    </div>
  </div>

  <!-- Load p5.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

  <script>
    let path = [];
    let player;
    let dragging = false;
    let gameState = "intro";
    let endZone;

    function setup() {
      createCanvas(windowWidth, windowHeight);
      setupPath();
      player = createVector(path[0].x, path[0].y);
      endZone = path[path.length - 1].copy();
    }

    function setupPath() {
      let margin = 100;
      let w = width - 2 * margin;
      let h = height - 2 * margin;
      let numPoints = 6;
      path = [];
      for (let i = 0; i < numPoints; i++) {
        let x = margin + (w / (numPoints - 1)) * i;
        let y = margin + random(h * 0.3, h * 0.7);
        path.push(createVector(x, y));
      }
    }

    function draw() {
      if (gameState === "intro") {
        clear();
        drawIntro();
      } else {
        background("#DDE8EA");
        drawMaze();
      }
    }

    function drawIntro() {
      textAlign(CENTER, CENTER);
      fill("#1C3D41");
      textSize(32);
      text("Micro-Break Game", width / 2, height / 2 - 40);

      drawStyledButton("Start", height / 2 + 20, () => {
        gameState = "play";
      });
    }

    function drawStyledButton(label, y, onClick) {
      let w = 280;
      let h = 48;
      let x = width / 2 - w / 2;

      fill("#C2D6D9");
      rect(x, y, w, h, 12);
      fill("#ffffff");
      textSize(16);
      text(label, x + w / 2, y + h / 2);

      if (mouseIsPressed &&
          mouseX > x && mouseX < x + w &&
          mouseY > y && mouseY < y + h) {
        onClick();
      }
    }

    function drawMaze() {
      fill("#1C3D41");
      textSize(14);
      text("Drag the circle along the curve to reach the other side.",
           width / 2, height * 0.1);

      noFill();
      stroke("#2F5C63");
      strokeWeight(0.035 * min(width, height));
      beginShape();
      curveVertex(path[0].x, path[0].y);
      for (let v of path) curveVertex(v.x, v.y);
      curveVertex(path[path.length - 1].x, path[path.length - 1].y);
      endShape();

      noStroke();
      fill("#ffffff");
      ellipse(endZone.x, endZone.y, 0.07 * min(width, height));

      fill("#C2D6D9");
      stroke("#1C3D41");
      ellipse(player.x, player.y, 0.06 * min(width, height));

      if (player.dist(endZone) < 0.04 * min(width, height)) {
        fill("#1C3D41");
        noStroke();
        textSize(24);
        text("You did it ðŸŽ‰", width / 2, height * 0.9);
      } else if (!dragging && !onPath(player)) {
        drawStrayMessage();
      }
    }

    function drawStrayMessage() {
      push();
      resetMatrix();
      noStroke();
      fill("#1C3D41");
      textSize(16);
      textAlign(CENTER, CENTER);
      text("Oops, it happens ðŸ˜„ Try staying closer to the path.",
           width / 2, height * 0.85);
      pop();
    }

    function onPath(p) {
      for (let v of path) {
        if (dist(p.x, p.y, v.x, v.y) < 80) return true;
      }
      return false;
    }

    function mousePressed() {
      if (dist(mouseX, mouseY, player.x, player.y) < 50) {
        dragging = true;
      }
    }

    function mouseDragged() {
      if (dragging) {
        player.x = mouseX;
        player.y = mouseY;
      }
    }

    function mouseReleased() {
      dragging = false;
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
    }
  </script>
</body>
</html>
